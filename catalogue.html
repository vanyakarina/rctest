<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogue Input</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        nav { /* your styles */ }
        .content { /* your styles */ }
        table { /* your styles */ }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="songwriters.html">Songwriters Input</a>
        <a href="catalogue.html">Catalogue Input</a>
        <a href="royalty.html">Royalty Calculation</a>
        <a href="royalty_report.html">Royalty Report</a>
    </nav>

    <div class="content">
        <h1>Catalogue Input</h1>
        <form id="catalogueForm">
            <label for="title">Song Title:</label>
            <input type="text" id="title" required>
            <label for="singer">Singer:</label>
            <input type="text" id="singer" required>
            <label for="releaseDate">Release Date:</label>
            <input type="date" id="releaseDate" required>
            <label for="distributor">Distributor:</label>
            <input type="text" id="distributor" required>
            <label for="isrc">ISRC:</label>
            <input type="text" id="isrc" required>
            <button type="button" onclick="addSong()">Add Song</button>
        </form>

        <h2>Catalogue List</h2>
        <table id="catalogueTable">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Singer</th>
                    <th>Release Date</th>
                    <th>Distributor</th>
                    <th>ISRC</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Catalogue items will be added here -->
            </tbody>
        </table>

        <button onclick="exportToExcel('catalogue', catalogue)">Export Catalogue to Excel</button>
        <input type="file" id="importFile" accept=".xlsx" onchange="importFromExcel(event, 'catalogue')"/>
    </div>

    <script>
        let catalogue = JSON.parse(localStorage.getItem('catalogue')) || [];

        function renderCatalogue() {
            const tableBody = document.getElementById('catalogueTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = '';

            catalogue.forEach((song, index) => {
                const row = tableBody.insertRow();
                row.insertCell(0).textContent = song.title;
                row.insertCell(1).textContent = song.singer;
                row.insertCell(2).textContent = song.releaseDate;
                row.insertCell(3).textContent = song.distributor;
                row.insertCell(4).textContent = song.isrc;
                const deleteCell = row.insertCell(5);
                deleteCell.innerHTML = `<button onclick="deleteSong(${index})">Delete</button>`;
            });
        }

        function addSong() {
            const title = document.getElementById('title').value;
            const singer = document.getElementById('singer').value;
            const releaseDate = document.getElementById('releaseDate').value;
            const distributor = document.getElementById('distributor').value;
            const isrc = document.getElementById('isrc').value;

            const newSong = { title, singer, releaseDate, distributor, isrc };
            catalogue.push(newSong);
            localStorage.setItem('catalogue', JSON.stringify(catalogue));
            renderCatalogue();
        }

        function deleteSong(index) {
            catalogue.splice(index, 1);
            localStorage.setItem('catalogue', JSON.stringify(catalogue));
            renderCatalogue();
        }

        function exportToExcel(sheetName, data) {
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, sheetName);
            XLSX.writeFile(wb, `${sheetName}.xlsx`);
        }

        function importFromExcel(event, sheetName) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet);

                if (sheetName === 'catalogue') {
                    catalogue = json;
                    localStorage.setItem('catalogue', JSON.stringify(catalogue));
                }
                renderCatalogue();
                alert('Data imported successfully!');
            };
            reader.readAsArrayBuffer(file);
        }

        // Initialize the page
        renderCatalogue();
    </script>
</body>
</html>
